@using WebAdmin.Models;
@using Resources;
@{
    ViewBag.Title = Resource.Menu_BasicData;
    ViewBag.Item = Resource.Menu_EWIMgmt;
    List<string> CategoryList = (List<string>)(ViewBag.CategoryList);
}
@section style{
    @*.append(
    $(_div, { 'class': classes.sScrollBody } )
    .css( {
    position: 'relative',
    overflow: 'auto',
    width: size( scrollX )
    } )
    .append( table )
    );
    和jquery.dataTables.js有冲突*@
}

<div class="card">
    <div class="card-body">
        <div class="row">
            <div class="col-5">
                <div class="row">
                    &nbsp;&nbsp;&nbsp;
                    <button id="btnRefresh" type="button" class="btn btn-info"><i class="fa fa-refresh"></i> @Resource.Txt_Refresh</button>&nbsp;
                    <button id="btnSync" type="button" class="btn btn-info"><i class="mdi mdi-cloud-sync"></i> @Resource.Txt_Synchronize</button>&nbsp;
                    <button id="btnAdd" type="button" class="btn btn-info"><i class="fa fa-plus"></i> @Resource.Txt_Add</button>
                </div>
            </div>
            <div class="col-7">
                <form class="input-form" id="DoSearch">
                    <div class="input-group pull-right">
                        <div class="input-group-btn">
                            <input type="hidden" name="SearchBy" id="SearchBy">
                            <button type="button" id="searchByTitle" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                @Resource.Txt_All
                            </button>
                            <div class="dropdown-menu" x-placement="top-start" style="position: absolute; transform: translate3d(0px, -2px, 0px); top: 0px; left: 0px; will-change: transform;" id="searchOptions">
                                <a class="dropdown-item Product" href="javascript:;" data-searchby="PartNum">@Resource.Txt_PartNumber</a>
                                <a class="dropdown-item Product" href="javascript:;" data-searchby="PartDesc">@Resource.Txt_Description</a>
                                <a class="dropdown-item Product" href="javascript:;" data-searchby="CustomerPartNum">@Resource.Txt_CustomerPartNum</a>
                                <a class="dropdown-item Machine" href="javascript:;" data-searchby="MachineName">@Resource.Txt_Machine</a>
                                <a class="dropdown-item Machine" href="javascript:;" data-searchby="MachineType">@Resource.Txt_Type</a>
                                <a class="dropdown-item TestInstrument" href="javascript:;" data-searchby="TestInstrument">@Resource.Txt_TestInstrument</a>
                                <a class="dropdown-item TestInstrument" href="javascript:;" data-searchby="Category">@Resource.Txt_Category</a>
                                <a class="dropdown-item" href="javascript:;" data-searchby="All">@Resource.Txt_All</a>
                            </div>
                        </div>
                        <input type="text" autocomplete="off" class="form-control" aria-label="Text input with dropdown button" id="SearchKeywords" name="SearchKeywords">
                        <span class="input-group-btn">
                            <button class="btn btn-secondary" type="button" id="btnSearch"><i class="fa fa-search"></i> @Resource.Txt_Search</button>
                            <button class="btn btn-info" type="button" id="btnShowAll"><i class="fa fa-list"></i> @Resource.Txt_ShowAll</button>
                        </span>
                    </div>
                </form>
            </div>
        </div>
        <div class="m-t-10" style="border-top: solid 1px #dddddd">
            <div class="row">
                <div class="vtabs col-2">
                    <ul class="nav nav-tabs tabs-vertical" id="ulInfo">
                        <li class="nav-item ulInfo" data-val="Product">
                            <a class="nav-link active" data-toggle="tab" href="#pnProduct" role="tab" aria-expanded="true">
                                <span class="hidden-xs-down">@Resource.Txt_Part</span>
                            </a>
                        </li>
                        <li class="nav-item ulInfo" data-val="Machine">
                            <a class="nav-link" data-toggle="tab" href="#pnMachine" role="tab" aria-expanded="false">
                                <span class="hidden-xs-down">@Resource.Txt_Machine</span>
                            </a>
                        </li>
                        <li class="nav-item ulInfo" data-val="TestInstrument">
                            <a class="nav-link" data-toggle="tab" href="#pnTestInstrument" role="tab" aria-expanded="false">
                                <span class="hidden-xs-down">@Resource.Txt_TestInstrument</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="col-10 tab-content">
                    <div class="tab-pane active" style="width:100%" id="pnProduct" role="tabpanel" aria-expanded="true">
                        <table id="myTableProduct" class="bordered" style="width:100%">
                            <thead>
                                <tr role="row">
                                    <th>@Resource.Txt_PartNumber</th>
                                    <th>@Resource.Txt_Description</th>
                                    <th>@Resource.Txt_CustomerPartNum</th>
                                    <th>@Resource.Txt_Revision</th>
                                    <th>@Resource.Txt_AlternateVersion</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <div class="tab-pane" style="width:100%" id="pnMachine" role="tabpanel" aria-expanded="false">
                        <table id="myTableMachine" class="bordered" style="width:100%">
                            <thead>
                                <tr role="row">
                                    <th>@Resource.Txt_Machine</th>
                                    <th>@Resource.Txt_Type</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <div class="tab-pane" style="width:100%" id="pnTestInstrument" role="tabpanel" aria-expanded="false">
                        <table id="myTableTestInstrument" class="bordered" style="width:100%">
                            <thead>
                                <tr role="row">
                                    <th>@(Resource.Txt_TestInstrument)(@Resource.Txt_Chinese)</th>
                                    <th>@(Resource.Txt_TestInstrument)(@Resource.Txt_English)</th>
                                    <th>@Resource.Txt_Category</th>
                                    <th>@Resource.Txt_Operation</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ModalTestInstrument" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="top:20%">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">@Resource.Txt_EditTestInstrument</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body card-body">
                <div class="row col-12 form-group">
                    <label class="col-sm-5">@(Resource.Txt_TestInstrument)(@Resource.Txt_Chinese)</label>
                    <input type="text" class="form-control col-sm-7" autocomplete="off" readonly id="txtTestInstrument" />
                </div>
                <div class="row col-12 form-group">
                    <label class="col-sm-5">@(Resource.Txt_TestInstrument)(@Resource.Txt_English)</label>
                    <input type="text" class="form-control col-sm-7" autocomplete="off" id="txtTestInstrument_EN" />
                </div>
                <div class="row col-12 form-group">
                    <label class="col-sm-5">@Resource.Txt_Category</label>
                    <input type="text" class="form-control col-sm-7" id="txtCategory" autocomplete="off" list="CategoryList" />
                    <datalist id="CategoryList">
                        @foreach (string Category in CategoryList)
                        {
                            <option value="@Category"></option>
                        }
                    </datalist>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btnModalClose" type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-close"></i> @Resource.Txt_Close</button>
                <button id="btnModalSave" type="button" class="btn btn-default"><i class="fa fa-save"></i> @Resource.Txt_Save</button>
            </div>
        </div>
    </div>
</div>

@section script {
    <script src="~/Scripts/ExportReport.js"></script>
    <script>
        var CurInfo = 'Product', InitialProduct = false, InitialMachine = true, InitialTestInstrument = true, SubmitType = "";
        var CONSTANT = {
            // datatables常量
            DATA_TABLES: {
                DEFAULT_OPTION: { // DataTables初始化选项
                    LANGUAGE: {
                        sProcessing: "@Resource.Txt_Processing...",
                        sLengthMenu: "@Resource.Txt_DisplayResults",
                        sZeroRecords: "@Resource.Txt_NoMatchedResults",
                        sInfo: "@Resource.Txt_DisplayAreaResults",
                        sInfoEmpty: "@Resource.Txt_DisplayAreaResults2",
                        sInfoFiltered: "(@Resource.Txt_FilterResults)",
                        sInfoPostFix: "",
                        sSearch: "@Resource.Txt_Search:",
                        searchPlaceholder: "@Resource.Txt_KeywordSearch",
                        sUrl: "",
                        sEmptyTable: "@Resource.Txt_DataEmpty",
                        sLoadingRecords: "@Resource.Txt_Loading...",
                        sInfoThousands: ",",
                        oPaginate: {
                            sFirst: "@Resource.Txt_First",
                            sPrevious: "@Resource.Txt_Previous",
                            sNext: "@Resource.Txt_Next",
                            sLast: "@Resource.Txt_Last"
                        },
                        oAria: {
                            sSortAscending: ": @Resource.Txt_Ascending",
                            sSortDescending: ": @Resource.Txt_Descending"
                        }
                    },
                    // 禁用自动调整列宽
                    autoWidth: false,
                    // 为奇偶行加上样式，兼容不支持CSS伪类的场合
                    stripeClasses: ["odd", "even"],
                    // 取消默认排序查询,否则复选框一列会出现小箭头
                    order: [],
                    // 隐藏加载提示,自行处理
                    processing: false,
                    // 启用服务器端分页
                    serverSide: true,
                    // 禁用原生搜索
                    searching: false
                },
                // 回调
                CALLBACKS: {
                    // 表格绘制前的回调函数
                    PREDRAWCALLBACK: function (settings) {
                        if (settings.oInit.scrollX == '100%') {
                            // 给表格添加css类，处理scrollX : true出现边框问题
                            $(settings.nTableWrapper).addClass('dataTables_DTS');
                        }
                    },
                    INITCOMPLETE: function (settings, json) {
                        if (settings.oInit.scrollX == '100%' && $(settings.nTable).parent().innerWidth() - $(settings.nTable).outerWidth() > 5) {
                            $(settings.nScrollHead).children().width('100%');
                            $(settings.nTHead).parent().width('100%');
                            $(settings.nTable).width('100%');
                        }
                    },
                    // 表格每次重绘回调函数
                    DRAWCALLBACK: function (settings) {
                        // 高亮显示当前行
                        $(settings.nTable).find("tbody tr").click(function (e) {
                            $(e.target).parents('table').find('tr').removeClass('warning');
                            $(e.target).parents('tr').addClass('warning');
                        });
                    }
                },
                // 常用render可以抽取出来，如日期时间、头像等
                RENDER: {
                    ELLIPSIS: function (data, type, row, meta) {
                        data = data || "";
                        return '<span title="' + data + '">' + data + '</span>';
                    }
                }
            }
        };

        var pageTableIdProduct = 'EWIBasicProduct', tableProduct,
            pageTableIdMachine = 'EWIBasicMachine', tableMachine,
            pageTableIdInstrument = 'EWIBasicInstrument', tableInstrument;
        var columnDefsProduct = [
            {
                "data": "PartNum",
                "width": '15%',
                "targets": 0
            },
            {
                "data": "PartDesc",
                "width": '46%',
                "orderable": false,
                "bSortable": false,
                "targets": 1
            },
            {
                "data": "CustomerPartNum",
                "width": '15%',
                "orderable": false,
                "bSortable": false,
                "targets": 2
            },
            {
                "data": "Revision",
                "width": '12%',
                "orderable": false,
                "bSortable": false,
                "targets": 3
                ,
                "render": function (data, type, row, meta) {
                    var content = '<a href="javascript:void(0);" onclick="LoadMsg(\'' + row["PartNum"] + ' : ' + data + '\', \'' + row["OPList"] + '\')">' + data + '</a>';
                    //var content = '<span class="mytooltip tooltip-effect-1"><span class="tooltip-item2">' + data + '</span>'
                    //content += '<span class="tooltip-content4 clearfix"><span class="tooltip-text2">' + row["OPList"] + '</span></span></span >';
                    return content;
                }
            },
            {
                "data": "AltMethod",
                "width": '12%',
                "orderable": false,
                "bSortable": false,
                "targets": 4
            }
        ];
        var columnDefsMachine = [
            {
                "data": "MachineName",
                "width": '50%',
                "targets": 0
            },
            {
                "data": "MachineType",
                "width": '50%',
                "orderable": false,
                "bSortable": false,
                "targets": 1
            }
        ];
        var columnDefsInstrument = [
            {
                "data": "TestInstrument",
                "width": '25%',
                "targets": 0
            },
            {
                "data": "TestInstrument_EN",
                "width": '25%',
                "orderable": false,
                "bSortable": false,
                "targets": 1
            },
            {
                "data": "Category",
                "width": '25%',
                "orderable": false,
                "bSortable": false,
                "targets": 2
            },
            {
                "data": "TestInstrument",
                "width": '25%',
                "orderable": false,
                "bSortable": false,
                "targets": 3,
                "render": function (data, type, row, meta) {
                    var content = '<button type="button" class="btn btn-info" onclick="LoadEditTestInstrument(\'' + data + '\',\'' + row["TestInstrument_EN"] + '\',\'' + row["Category"] + '\')"><i class="fa fa-edit"></i> @Resource.Txt_Edit</button>'
                    content += '&nbsp;<button type="button" class="btn btn-info" onclick="DeleteTestInstrument(\'' + data + '\')"><i class="mdi mdi-delete"></i> @Resource.Txt_Delete</button>';

                    return content;
                }
            }
        ];

        $(document).ready(function () {
            loadDataTable();

            //加载下拉框
            $('.ulInfo').click(function () {
                CurInfo = $(this).attr('data-val');
                LoadData();
            });
            LoadData();

            //隐藏搜索框
            $("#myTableProduct_filter").hide();
            $("#myTableMachine_filter").hide();
            $("#myTableTestInstrument_filter").hide();

            $("#searchOptions a").click(function () {
                var getSearchByText = $(this).text().trim();
                var getSearchByValue = $(this).attr("data-searchby");

                $("#searchByTitle").text(getSearchByText);
                $("#SearchBy").val(getSearchByValue);
            });

            $('#SearchKeywords').on("keypress", function () {
                if (event.keyCode == "13") {
                    event.preventDefault();
                    $("#btnSearch").click();
                }
            });

            $("#btnSearch").click(function () {
                var table;
                switch (CurInfo) {
                    case "Product":
                        table = $('#myTableProduct').DataTable();
                        break;
                    case "Machine":
                        table = $('#myTableMachine').DataTable();
                        break;
                    case "TestInstrument":
                        table = $('#myTableTestInstrument').DataTable();
                        break;
                    default:
                        table = $('#myTableProduct').DataTable();
                        break;
                }

                var searchby = $("#SearchBy").val();
                var searchvalue = $("#SearchKeywords").val();

                table.search("");
                table.columns(0).search("");
                table.columns(1).search("");
                table.columns(2).search("");
                table.columns(3).search("");

                if (searchby == "" || searchby == "All") {
                    table.search(searchvalue);
                    table.draw();
                } else {
                    if (CurInfo == "Product") {
                        switch (searchby) {
                            case "PartNum":
                                table.columns(0).search(searchvalue);
                                break;
                            case "PartDesc":
                                table.columns(1).search(searchvalue);
                                break;
                            case "CustomerPartNum":
                                table.columns(2).search(searchvalue);
                                break;
                            default:
                                break;
                        }
                    }
                    else if (CurInfo == "Machine") {
                        switch (searchby) {
                            case "MachineName":
                                table.columns(0).search(searchvalue);
                                break;
                            case "MachineType":
                                table.columns(1).search(searchvalue);
                                break;
                            default:
                                break;
                        }
                    }
                    else {
                        switch (searchby) {
                            case "TestInstrument":
                                table.columns(0).search(searchvalue);
                                break;
                            case "Category":
                                table.columns(1).search(searchvalue);
                                break;
                            default:
                                break;
                        }
                    }

                    table.draw();
                }
                if (searchby != "Date") {
                    $("#SearchKeywords").focus();
                }
            });

            $("#btnShowAll").click(function () {
                ShowAll();
            });

            $("#btnRefresh").click(function () {
                ShowAll();
            });

            $("#btnSync").click(function () {
                SyncPartNum();
            });

            $("#btnModalSave").click(function () {
                SubmitTestInstrument();
            });

            $('#btnAdd').click(function () {
                LoadAddTestInstrument();
            });
        });

        function loadDataTable(LoadType = 0) {

            if (LoadType == 0 || LoadType == 1) {
                setUserColumnsDefWidths(pageTableIdProduct, columnDefsProduct);
                tableProduct = $('#myTableProduct').DataTable(
                    {
                        language: {
                            "sProcessing": "@Resource.Txt_Processing...",
                            "sLengthMenu": "@Resource.Txt_DisplayResults",
                            "sZeroRecords": "@Resource.Txt_NoMatchedResults",
                            "sInfo": "@Resource.Txt_DisplayAreaResults",
                            "sInfoEmpty": "@Resource.Txt_DisplayAreaResults2",
                            "sInfoFiltered": "(@Resource.Txt_FilterResults)",
                            "sInfoPostFix": "",
                            "sSearch": "@Resource.Txt_Search:",
                            "sUrl": "",
                            "sEmptyTable": "@Resource.Txt_DataEmpty",
                            "sLoadingRecords": "@Resource.Txt_Loading...",
                            "sInfoThousands": ",",
                            "oPaginate": {
                                "sFirst": "@Resource.Txt_First",
                                "sPrevious": "@Resource.Txt_Previous",
                                "sNext": "@Resource.Txt_Next",
                                "sLast": "@Resource.Txt_Last"
                            },
                            "oAria": {
                                "sSortAscending": ": @Resource.Txt_Ascending",
                                "sSortDescending": ": @Resource.Txt_Descending"
                            }
                        },
                        destroy: true,
                        scrollY: 400,
                        scrollX: true,
                        scrollCollapse: true,
                        scroller: true,
                        initComplete: function (settings) {
                            //Add JQueryUI resizable functionality to each th in the ScrollHead table
                            $('#myTableProduct_wrapper .dataTables_scrollHead thead th').resizable({
                                handles: "e",
                                alsoResize: '#myTableProduct_wrapper .dataTables_scrollHead table', //Not essential but makes the resizing smoother
                                stop: function () {
                                    saveColumnSettings(pageTableIdProduct, tableProduct);
                                    loadDataTable(1);
                                }
                            });
                        },
                        "autoWidth": false,
                        "bAutoWidth": false,
                        "processing": true,
                        "serverSide": true,
                        "searching": true,
                        "ajax": {
                            "url": "/BasicData/GetEWIList",
                            "type": "POST",
                            "data": {
                                TableType: 0,
                                IsInitial: function () {
                                    return InitialProduct;
                                }
                            },
                        },
                        "aLengthMenu": [10, 25, 50, 100],
                        "iDisplayLength": 10,
                        "order": [],
                        "columns": columnDefsProduct
                    }
            );
            }

            if (LoadType == 0 || LoadType == 2) {
                setUserColumnsDefWidths(pageTableIdMachine, columnDefsMachine);
                tableMachine = $('#myTableMachine').DataTable(
                    {
                        language: {
                            "sProcessing": "@Resource.Txt_Processing...",
                            "sLengthMenu": "@Resource.Txt_DisplayResults",
                            "sZeroRecords": "@Resource.Txt_NoMatchedResults",
                            "sInfo": "@Resource.Txt_DisplayAreaResults",
                            "sInfoEmpty": "@Resource.Txt_DisplayAreaResults2",
                            "sInfoFiltered": "(@Resource.Txt_FilterResults)",
                            "sInfoPostFix": "",
                            "sSearch": "@Resource.Txt_Search:",
                            "sUrl": "",
                            "sEmptyTable": "@Resource.Txt_DataEmpty",
                            "sLoadingRecords": "@Resource.Txt_Loading...",
                            "sInfoThousands": ",",
                            "oPaginate": {
                                "sFirst": "@Resource.Txt_First",
                                "sPrevious": "@Resource.Txt_Previous",
                                "sNext": "@Resource.Txt_Next",
                                "sLast": "@Resource.Txt_Last"
                            },
                            "oAria": {
                                "sSortAscending": ": @Resource.Txt_Ascending",
                                "sSortDescending": ": @Resource.Txt_Descending"
                            }
                        },
                        destroy: true,
                        scrollY: 400,
                        scrollX: true,
                        scrollCollapse: true,
                        scroller: true,
                        initComplete: function (settings) {
                            //Add JQueryUI resizable functionality to each th in the ScrollHead table
                            $('#myTableMachine_wrapper .dataTables_scrollHead thead th').resizable({
                                handles: "e",
                                alsoResize: '#myTableMachine_wrapper .dataTables_scrollHead table', //Not essential but makes the resizing smoother
                                stop: function () {
                                    saveColumnSettings(pageTableIdMachine, tableMachine);
                                    loadDataTable(2);
                                }
                            });
                        },
                        "autoWidth": false,
                        "bAutoWidth": false,
                        "processing": true,
                        "serverSide": true,
                        "searching": true,
                        "ajax": {
                            "url": "/BasicData/GetEWIList",
                            "type": "POST",
                            "data": {
                                TableType: 1,
                                IsInitial: function () {
                                    return InitialMachine;
                                }
                            },
                        },
                        "aLengthMenu": [10, 25, 50, 100],
                        "iDisplayLength": 10,
                        "order": [],
                        "columns": columnDefsMachine
                    }
                );
            }

            if (LoadType == 0 || LoadType == 3) {
                setUserColumnsDefWidths(pageTableIdInstrument, columnDefsInstrument);
                tableInstrument = $('#myTableTestInstrument').DataTable(
                    {
                        language: {
                            "sProcessing": "@Resource.Txt_Processing...",
                            "sLengthMenu": "@Resource.Txt_DisplayResults",
                            "sZeroRecords": "@Resource.Txt_NoMatchedResults",
                            "sInfo": "@Resource.Txt_DisplayAreaResults",
                            "sInfoEmpty": "@Resource.Txt_DisplayAreaResults2",
                            "sInfoFiltered": "(@Resource.Txt_FilterResults)",
                            "sInfoPostFix": "",
                            "sSearch": "@Resource.Txt_Search:",
                            "sUrl": "",
                            "sEmptyTable": "@Resource.Txt_DataEmpty",
                            "sLoadingRecords": "@Resource.Txt_Loading...",
                            "sInfoThousands": ",",
                            "oPaginate": {
                                "sFirst": "@Resource.Txt_First",
                                "sPrevious": "@Resource.Txt_Previous",
                                "sNext": "@Resource.Txt_Next",
                                "sLast": "@Resource.Txt_Last"
                            },
                            "oAria": {
                                "sSortAscending": ": @Resource.Txt_Ascending",
                                "sSortDescending": ": @Resource.Txt_Descending"
                            }
                        },
                        destroy: true,
                        scrollY: 400,
                        scrollX: true,
                        scrollCollapse: true,
                        scroller: true,
                        initComplete: function (settings) {
                            //Add JQueryUI resizable functionality to each th in the ScrollHead table
                            $('#myTableTestInstrument_wrapper .dataTables_scrollHead thead th').resizable({
                                handles: "e",
                                alsoResize: '#myTableTestInstrument_wrapper .dataTables_scrollHead table', //Not essential but makes the resizing smoother
                                stop: function () {
                                    saveColumnSettings(pageTableIdInstrument, tableInstrument);
                                    loadDataTable(3);
                                }
                            });
                        },
                        "autoWidth": false,
                        "bAutoWidth": false,
                        "processing": true,
                        "serverSide": true,
                        "searching": true,
                        "ajax": {
                            "url": "/BasicData/GetEWIList",
                            "type": "POST",
                            "data": {
                                TableType: 2,
                                IsInitial: function () {
                                    return InitialTestInstrument;
                                }
                            },
                        },
                        "colReorder": true,
                        "aLengthMenu": [10, 25, 50, 100],
                        "iDisplayLength": 10,
                        "order": [],
                        "bAutoWidth": false,
                        "columns": columnDefsInstrument
                    }
                );
            }
        }
        function LoadAddTestInstrument() {
            SubmitType = "add";
            $('#txtTestInstrument').val('').removeAttr('readonly');
            $('#txtTestInstrument_EN').val('');
            $('#txtCategory').val('');
            $("#ModalTestInstrument").modal();
        }

        function LoadEditTestInstrument(TestInstrument, TestInstrument_EN, Category) {
            SubmitType = "edit";
            $('#txtTestInstrument').val(TestInstrument).attr('readonly','readonly');
            $('#txtTestInstrument_EN').val(TestInstrument_EN);
            $('#txtCategory').val(Category);
            $("#ModalTestInstrument").modal();
        }

        function SubmitTestInstrument() {
            LoadWaitMsg('@Resource.Txt_Editing......');
            $.ajax({
                type: "POST",
                url: "/BasicData/SubmitTestInstrument",
                async: true,
                data: {
                    TestInstrument: $('#txtTestInstrument').val(),
                    TestInstrument_EN: $('#txtTestInstrument_EN').val(),
                    Category: $('#txtCategory').val(),
                    SubmitType: SubmitType
                },
                dataType: "json",
                success: function (getResponse) {
                    CloseWaitMsg();
                    $("#ModalTestInstrument").modal("hide");
                    var Msg = getResponse.Msg;
                    if (Msg != "") {
                        swal('@Resource.Txt_OperationFailed', Msg, 'error');
                    }
                    else {
                        swal('@Resource.Txt_OperationSucceeded', Msg, 'success');
                        $("#btnSearch").click();
                    }
                },
                error: function (xhr) {
                    CloseWaitMsg();
                    $("#ModalTestInstrument").modal("hide");
                    swal("@Resource.Txt_OperationFailed", xhr.status + " " + xhr.statusText, 'error');
                }
            });
        }

        function DeleteTestInstrument(TestInstrument) {
            console.log(TestInstrument);
            swal({
                title: '@Resource.Txt_DeleteConfirm1' + TestInstrument + '@Resource.Txt_DeleteConfirm2',
                text: '',
                type: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: '@Resource.Txt_Confirm',
                cancelButtonText: '@Resource.Txt_Cancel',
                confirmButtonClass: 'btn btn-success',
                cancelButtonClass: 'btn btn-danger',
                buttonsStyling: false
            }).then(function (isConfirm) {
                if (isConfirm.value == true) {
                    LoadWaitMsg('@Resource.Txt_Deleting......');
                    $.ajax({
                        type: "POST",
                        url: "/BasicData/DeleteTestInstrument",
                        async: true,
                        data: {
                            TestInstrument: TestInstrument
                        },
                        dataType: "json",
                        success: function (getResponse) {
                            CloseWaitMsg();
                            var Msg = getResponse.Msg;
                            if (Msg != "") {
                                swal('@Resource.Txt_DeleteFailed', Msg, 'error');
                            }
                            else {
                                swal('@Resource.Txt_DeleteSucceeded', Msg, 'success');
                                $("#btnSearch").click();
                            }
                        },
                        error: function (xhr) {
                            CloseWaitMsg();
                            swal("@Resource.Txt_DeleteFailed", xhr.status + " " + xhr.statusText, 'error');
                        }
                    });
                }
            });
        }

        function LoadData() {
            switch (CurInfo) {
                case "Product":
                    $('#btnAdd').attr('style', 'display:none;');
                    $('.Product').attr('style', 'display:block;');
                    $('.Machine').attr('style', 'display:none;');
                    $('.TestInstrument').attr('style', 'display:none;');
                    break;
                case "Machine":
                    $('#btnAdd').attr('style', 'display:none;');
                    $('.Product').attr('style', 'display:none;');
                    $('.Machine').attr('style', 'display:block;');
                    $('.TestInstrument').attr('style', 'display:none;');
                    if (InitialMachine) {
                        InitialMachine = false;
                        ShowAll();
                    }
                    break;
                case "TestInstrument":
                    $('#btnAdd').attr('style', 'display:block;');
                    $('.Product').attr('style', 'display:none;');
                    $('.Machine').attr('style', 'display:none;');
                    $('.TestInstrument').attr('style', 'display:block;');
                    if (InitialTestInstrument) {
                        InitialTestInstrument = false;
                        ShowAll();
                    }
                    break;
                default:
                    break;
            }

            $("#searchByTitle").text('@Resource.Txt_All');
            $("#SearchBy").val('All');
            $('#SearchKeywords').val('');
        }

        function ShowAll() {
            var table;
            switch (CurInfo) {
                case "Product":
                    table = $('#myTableProduct').DataTable();
                    break;
                case "Machine":
                    table = $('#myTableMachine').DataTable();
                    break;
                case "TestInstrument":
                    table = $('#myTableTestInstrument').DataTable();
                    break;
                default:
                    table = $('#myTableProduct').DataTable();
                    break;
            }

            table.search("");
            table.columns(0).search("");
            table.columns(1).search("");
            table.columns(2).search("");
            table.columns(3).search("");

            table.draw();
        }

        function SyncPartNum() {
            swal({
                title: '@Resource.Txt_SynchronizeConfirm1' + '<br />' + '@Resource.Txt_SynchronizeConfirm2',
                text: '',
                type: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: '@Resource.Txt_Confirm',
                cancelButtonText: '@Resource.Txt_Cancel',
                confirmButtonClass: 'btn btn-success',
                cancelButtonClass: 'btn btn-danger',
                buttonsStyling: false
            }).then(function (isConfirm) {
                if (isConfirm.value == true) {
                    LoadWaitMsg('@Resource.Txt_Synchronizing......');
                    $.ajax({
                        type: "POST",
                        url: "/BasicData/SyncEWIPartNum",
                        async: true,
                        dataType: "json",
                        success: function (getResponse) {
                            CloseWaitMsg();
                            var Msg = getResponse.Msg;
                            if (Msg != "") {
                                swal('@Resource.Txt_SynchronizeFailed', Msg, 'error');
                            }
                            else {
                                swal('@Resource.Txt_SynchronizeSucceeded', Msg, 'success');
                                $("#btnSearch").click();
                            }
                        },
                        error: function (xhr) {
                            CloseWaitMsg();
                            swal("@Resource.Txt_SynchronizeFailed", xhr.status + " " + xhr.statusText, 'error');
                        }
                    });
                }
            });
        }

    </script>
}